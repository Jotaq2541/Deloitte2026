
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Asistente Deloitte ‚Äì Marketplace CA</title>
<meta name="description" content="Asistente con avatar y voz neutral latinoamericana. Preguntas y respuestas sobre el Marketplace Deloitte Centroam√©rica." />
<!-- v3.3 ‚Äì Im√°genes integradas, Q&A render, TTS robusto -->
<style>
  :root{
    --bg:#0b0e11; --panel:#111418; --card:#141a1f;
    --brand:#1c8c3f; --brand-2:#20a34a; --text:#ffffff; --muted:#b9c0c7;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:radial-gradient(1200px 600px at 20% 0%,#0e1117 0%,var(--bg) 60%);
    color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif
  }
  header{
    padding:16px 20px;border-bottom:2px solid var(--brand);background:#0f1317;
    display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap
  }
  header h1{margin:0;font-size:18px;font-weight:700;white-space:nowrap}
  .wrap{display:grid;grid-template-columns:360px 1fr;gap:16px;padding:16px}
  @media (max-width: 900px){ .wrap{grid-template-columns:1fr} }

  .left,.right{
    background:linear-gradient(180deg,rgba(255,255,255,.02),transparent 180px);
    border:1px solid rgba(255,255,255,.08);border-radius:14px
  }
  .left{padding:14px;display:grid;grid-template-rows:auto auto 1fr;gap:14px}

  /* AVATAR (imagen + capas) */
  .avatar{
    position:relative;aspect-ratio:4/5;border-radius:12px;overflow:hidden;
    background:#07090d;border:1px solid rgba(32,163,74,.35);
    box-shadow:0 0 0 1px rgba(32,163,74,.12),0 18px 60px rgba(0,0,0,.35)
  }
  .avatar img#avatarImg{
    position:absolute;inset:0;width:100%;height:100%;
    object-fit:cover;object-position:center;display:block
  }
  .scan{
    position:absolute;inset:0;pointer-events:none;
    background:
      linear-gradient(rgba(0,255,200,.08),transparent,rgba(0,255,200,.08)),
      repeating-linear-gradient(0deg,rgba(0,255,180,.10),rgba(0,255,180,.10) 1px,transparent 1px,transparent 3px);
    mix-blend-mode:screen;animation:sweep 4s linear infinite
  }
  @keyframes sweep{0%{background-position:0 0,0 0}100%{background-position:0 100%,0 0}}
  .subtitle{
    position:absolute;bottom:8px;left:8px;right:8px;background:rgba(0,0,0,.45);
    backdrop-filter:blur(4px);padding:8px;border-radius:8px;font-size:12px;max-height:38%;overflow:auto
  }
  .talking{box-shadow:0 0 0 1px rgba(32,163,74,.2),0 0 25px rgba(32,163,74,.35),0 18px 60px rgba(0,0,0,.35)}

  .muted{color:var(--muted);font-size:12px}
  .right{display:grid;grid-template-rows:auto 1fr auto}
  .panel{padding:12px 14px;border-bottom:1px solid rgba(255,255,255,.08);display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .panel h2{margin:0;font-size:16px}
  .controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  select,button{background:#0f1216;color:var(--text);border:1px solid rgba(255,255,255,.14);border-radius:8px;padding:8px 10px;font-size:14px}
  .btn{cursor:pointer}
  .btn-primary{background:linear-gradient(180deg,#1f2937,#0f1216);border:1px solid rgba(32,163,74,.5);box-shadow:inset 0 1px 0 rgba(255,255,255,.06),0 0 0 2px rgba(32,163,74,.12)}
  .btn-ghost{background:#0f1216}
  .grid{display:grid;grid-template-columns:1fr;gap:12px;padding:14px;background:rgba(0,0,0,.18)}
  .qbtn{width:100%;text-align:left;padding:12px;border:1px solid rgba(255,255,255,.06);background:#12151b;border-radius:10px;cursor:pointer;line-height:1.35}
  .qbtn:hover{border-color:rgba(32,163,74,.45);box-shadow:0 0 0 2px rgba(32,163,74,.12) inset}
  .answer{padding:16px;border-top:1px solid rgba(255,255,255,.08);background:#101419;min-height:160px}
  footer{padding:10px 16px;color:var(--muted)}
  .logo{height:22px;vertical-align:middle;opacity:.95}
  .kbd{border:1px solid rgba(255,255,255,.2);padding:0 6px;border-radius:6px;background:#0f1216}
</style>
</head>
<body>
  <header>
    <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
      <!-- LOGO -->
      Deloitte-Emblem.png
      <h1>Asistente Virtual ‚Äì Marketplace Deloitte CA</h1>
    </div>
    <div class="controls">
      <label>Voz:
        <select id="voiceSel" title="Voz neutral latinoamericana" aria-label="Seleccionar voz"></select>
      </label>
      <button id="btnSpeak"  class="btn btn-primary" title="Reproducir √∫ltima respuesta" aria-label="Reproducir">üîä Reproducir</button>
      <button id="btnPause"  class="btn btn-ghost"   title="Pausar/Reanudar audio"     aria-label="Pausar o reanudar">‚è∏Ô∏è Pausar</button>
      <button id="btnStop"   class="btn btn-ghost"   title="Detener audio"             aria-label="Detener">‚èπÔ∏è Detener</button>
    </div>
  </header>

  <main class="wrap">
    <!-- Izquierda: AVATAR -->
    <section class="left">
      <div id="avatar" class="avatar" aria-label="Avatar hologr√°fico">
        1000_F_827852536_YuGWoMW0rpFSyAXCHqYfv2QCD2AowPaj.jpg
        <div class="scan" aria-hidden="true"></div>
        <div id="subtitle" class="subtitle" aria-live="polite"></div>
      </div>

      <div class="muted">
        Sugerencia: usa <span class="kbd">R</span> para reproducir/pausar y <span class="kbd">S</span> para detener por teclado.
      </div>
    </section>

    <!-- Derecha: Q&A -->
    <section class="right">
      <div class="panel">
        <h2>Preguntas frecuentes ‚Äì Marketplace Deloitte CA</h2>
        <div class="controls">
          <small class="muted">Haz clic en una pregunta para ver la respuesta y reproducirla.</small>
        </div>
      </div>

      <div class="grid" id="faqGrid" role="list">
        <!-- Botones de preguntas generados por JS -->
      </div>

      <div id="answerBox" class="answer" aria-live="polite">
        Selecciona una pregunta para ver la respuesta aqu√≠.
      </div>

      <footer>
        ¬© 2026 Deloitte & Touche, S.A. ‚Äî Demostraci√≥n de asistente con TTS. Recomendado: Chrome/Edge.
      </footer>
    </section>
  </main>

<script>
/* ====== INICIALIZACI√ìN SEGURA ====== */
document.addEventListener('DOMContentLoaded', () => {
  try {
    initApp();
  } catch (err) {
    console.error('Fallo en initApp:', err);
    alert('Ocurri√≥ un problema inicializando la app. Revisa la consola.');
  }
});

function initApp(){
  // ----- Q&A (Marketplace CA) -----
  const QA = [
    {
      q: "¬øQu√© es el Marketplace Deloitte Centroam√©rica?",
      a: "Es la plataforma regional que integra las capacidades, servicios y soluciones de Deloitte en Guatemala, Honduras, El Salvador, Nicaragua, Costa Rica, Panam√° y Rep√∫blica Dominicana. Nace como una decisi√≥n estrat√©gica en septiembre de 2025 para impulsar el crecimiento y consolidar la presencia multidisciplinaria de la Firma en la regi√≥n."
    },
    {
      q: "¬øPor qu√© se cre√≥ el Marketplace regional en 2025?",
      a: "El Marketplace se cre√≥ para responder a las oportunidades y exigencias del mercado centroamericano, fortaleciendo la estructura societaria y ampliando las capacidades t√©cnicas. Durante 2025 se incorporaron 25 nuevos socios, sum√°ndose a los 60 existentes, lo que expandi√≥ significativamente las competencias disponibles."
    },
    {
      q: "¬øEn qu√© pa√≠ses opera el Marketplace Deloitte Centroam√©rica?",
      a: "Opera en siete pa√≠ses: Guatemala, Honduras, El Salvador, Nicaragua, Costa Rica, Panam√° y Rep√∫blica Dominicana. La plataforma integra talento, capacidades sectoriales y servicios de toda la regi√≥n."
    },
    {
      q: "¬øCu√°ntos profesionales integran Deloitte en la regi√≥n?",
      a: "M√°s de 80 socios y un s√≥lido equipo de profesionales distribuidos as√≠: Guatemala (242), Honduras (62), El Salvador (93), Nicaragua (28), Costa Rica (421), Panam√° (229) y Rep√∫blica Dominicana (113)."
    },
    {
      q: "¬øQu√© √°reas de servicio est√°n representadas dentro del Marketplace?",
      a: "El Marketplace integra capacidades de auditor√≠a, impuestos, servicios legales, consultor√≠a, riesgos y asesor√≠a financiera, facilitando el acceso unificado a las competencias regionales."
    },
    {
      q: "¬øCu√°l es la participaci√≥n de Deloitte en empresas p√∫blicas auditadas dentro del Marketplace CA?",
      a: "Deloitte audita el 11% de las compa√±√≠as listadas en las bolsas de valores de los siete pa√≠ses del Marketplace, lo que representa 51 empresas auditadas de un total de 457 en 2025."
    },
    {
      q: "¬øQu√© reconocimientos y reputaci√≥n respaldan al Marketplace CA?",
      a: "Las firmas de la regi√≥n han recibido m√∫ltiples reconocimientos Merco: Deloitte Costa Rica lidera rankings en Auditor√≠a y Consultor√≠a, Responsabilidad ESG y Talento; Honduras encabeza rankings de Auditor√≠a; Panam√° lidera rankings de Consultor√≠a ESG. Estos respaldos fortalecen la credibilidad del Marketplace."
    },
    {
      q: "¬øQu√© certificaciones posee Deloitte en la regi√≥n?",
      a: "Entre las certificaciones destacan: ISO/IEC 27001:2022 (seguridad de la informaci√≥n), Bandera Azul Ecol√≥gica 2024 en Costa Rica, Panam√° y Guatemala, y certificaci√≥n LEED Gold (ID+C v4) para oficinas de Deloitte Costa Rica."
    },
    {
      q: "¬øC√≥mo contribuye Deloitte CA a los medios y la generaci√≥n de eminencia?",
      a: "El Marketplace publica contenido en medios Tier 1 de forma gratuita y con aprobaci√≥n de Deloitte Spanish Latin America. La firma mantiene presencia en medios l√≠deres de la regi√≥n, fortaleciendo su posicionamiento."
    },
    {
      q: "¬øQu√© revistas regionales amplifican la presencia del Marketplace Deloitte CA?",
      a: "Presencia en revistas como Summa, Estrategia y Negocios, Vida y √âxito, Mercados & Tendencias, Forbes Centroam√©rica y Rep√∫blica Dominicana, e IT Now, lo cual potencia la visibilidad de sus capacidades y liderazgo."
    }
  ];

  // ----- DOM refs -----
  const voiceSel   = document.getElementById('voiceSel');
  const btnSpeak   = document.getElementById('btnSpeak');
  const btnPause   = document.getElementById('btnPause');
  const btnStop    = document.getElementById('btnStop');
  const faqGrid    = document.getElementById('faqGrid');
  const answerBox  = document.getElementById('answerBox');
  const subtitleEl = document.getElementById('subtitle');
  const avatar     = document.getElementById('avatar');

  // Sanidad b√°sica de nodos
  if (!faqGrid || !answerBox || !subtitleEl || !avatar) {
    throw new Error('Faltan nodos esenciales en el DOM.');
  }

  // ----- Render de preguntas -----
  faqGrid.innerHTML = "";
  QA.forEach((item, idx) => {
    const btn = document.createElement('button');
    btn.className = 'qbtn';
    btn.setAttribute('role','listitem');
    btn.textContent = (idx+1) + ". " + item.q;
    btn.addEventListener('click', () => {
      setAnswer(item.a);
      speakText(item.a);
    });
    faqGrid.appendChild(btn);
  });

  function setAnswer(text){
    answerBox.textContent = text;
    subtitleEl.textContent = text;
  }

  // ----- Speech Synthesis -----
  const synth = window.speechSynthesis;
  let voices = [];
  let lastUtterance = null;

  function loadVoices(){
    try{
      voices = synth.getVoices();
      voiceSel.innerHTML = "";
      const preferred = [
        /spanish.*(mexico|latin|latino)/i,
        /esmx|ar|cl|co|pe|uy|bo|py|ec|ve/i,
        /spanish.*(united states)/i,
        /spanish/i
      ];

      if (!voices || voices.length === 0) {
        const opt = document.createElement('option');
        opt.value = "";
        opt.textContent = "Sin voces disponibles (haz clic en la p√°gina e intenta de nuevo)";
        voiceSel.appendChild(opt);
        return;
      }

      voices.forEach((v) => {
        const opt = document.createElement('option');
        opt.value = v.name;
        opt.textContent = `${v.name} ‚Äî ${v.lang}${v.default ? " (default)" : ""}`;
        voiceSel.appendChild(opt);
      });

      for (const rx of preferred) {
        const match = voices.find(v => rx.test(`${v.name} ${v.lang}`));
        if (match) { voiceSel.value = match.name; break; }
      }
    } catch(e){
      console.warn('Error cargando voces', e);
    }
  }

  // Carga inicial + evento del navegador
  loadVoices();
  if (typeof speechSynthesis !== 'undefined' && 'onvoiceschanged' in speechSynthesis) {
    speechSynthesis.onvoiceschanged = loadVoices;
  }

  function getSelectedVoice(){
    const name = voiceSel.value;
    return voices.find(v => v.name === name) || voices.find(v => /spanish/i.test(v.lang)) || voices[0] || null;
  }

  function speakText(text){
    stopSpeaking(true); // silencio inmediato
    if (!text || !('speechSynthesis' in window)) return;

    const u = new SpeechSynthesisUtterance(text);
    const v = getSelectedVoice();
    if (v) u.voice = v;
    u.lang = (v && v.lang) ? v.lang : 'es-ES';
    u.rate = 1;
    u.pitch = 1;
    u.volume = 1;

    u.onstart = () => avatar.classList.add('talking');
    u.onend   = () => avatar.classList.remove('talking');
    u.onerror = (e) => { console.warn('Error TTS', e); avatar.classList.remove('talking'); };

    lastUtterance = u;
    synth.speak(u);
  }

  function pauseResume(){
    if (!('speechSynthesis' in window)) return;
    if (synth.speaking && !synth.paused) {
      synth.pause();
      avatar.classList.remove('talking');
    } else if (synth.paused) {
      synth.resume();
      avatar.classList.add('talking');
    } else if (lastUtterance) {
      synth.speak(lastUtterance);
    }
  }

  function stopSpeaking(immediate=false){
    if (!('speechSynthesis' in window)) return;
    if (immediate) {
      synth.cancel();
    } else {
      synth.pause(); synth.cancel(); synth.resume();
    }
    avatar.classList.remove('talking');
  }

  // Controles UI
  document.getElementById('btnSpeak').addEventListener('click', () => {
    const text = answerBox.textContent?.trim();
    if (text) speakText(text);
  });
  document.getElementById('btnPause').addEventListener('click', pauseResume);
  document.getElementById('btnStop').addEventListener('click', () => stopSpeaking(true));

  // Atajos: R = reproducir/pausar, S = detener
  document.addEventListener('keydown', (e) => {
    const tag = (e.target && e.target.tagName) || "";
    if (['INPUT','TEXTAREA','SELECT','BUTTON'].includes(tag)) return;
    if (e.key.toLowerCase() === 'r') {
      e.preventDefault();
      if (speechSynthesis.paused) {
        pauseResume();
      } else {
        const text = answerBox.textContent?.trim();
        if (text) speakText(text);
      }
    } else if (e.key.toLowerCase() === 's') {
      e.preventDefault();
      stopSpeaking(true);
    }
  });

  // Mensaje inicial
  setAnswer("Bienvenido/a. Selecciona una pregunta para ver la respuesta y reproducirla con voz.");
}
</script>
</body>
</html>
